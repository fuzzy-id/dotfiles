// hihgly inspired by:
// http://emacs-fu.blogspot.com/2010/12/conkeror-web-browsing-emacs-way.html

homepage = "http://www.tagesschau.de/"

clicks_in_new_buffer_target = OPEN_NEW_BUFFER_BACKGROUND;

minibuffer_auto_complete_default = true;
url_completion_use_bookmarks = true;
url_completion_use_history = true;

editor_shell_command = "emacsclient -c";

interactive("reload-config", "reload .conkerorrc",
	    function(I) {
		load_rc();
		I.window.minibuffer.message("config reloaded.");
	    }
	   );

define_key(default_global_keymap, "C-c r", "reload_config");

// integration with org-mode

function org_capture(url, title, selection, window) {
    var cmd_str = 
	'emacsclient \"org-protocol:/capture:/w/'+url+'/'+title+'/'+selection+'\"';
    if (window != null) {
	window.minibuffer.message('Issuing ' + cmd_str);
    }
    shell_command_blind(cmd_str);
}

interactive("org-capture", "Clip url, title, and selection to capture via org-protocol",
	    function(I) {
		org_capture(encodeURIComponent(I.buffer.document.title),
			    encodeURIComponent(I.buffer.document.title),
			    encodeURIComponent(I.buffer.top_frame.getSelection()),
			    I.window);
	    });

define_key(content_buffer_normal_keymap, "C-c c", "org-capture");